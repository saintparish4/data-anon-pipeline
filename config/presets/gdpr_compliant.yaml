# GDPR Compliant Anonymization Preset
# Conservative approach prioritizing privacy protection
# Suitable for: Data sharing with third parties, regulatory compliance
# Reference: GDPR Article 32 (Security of Processing), Article 25 (Data Protection by Design)

metadata:
  name: "GDPR Compliant"
  version: "1.0"
  description: "Conservative anonymization for GDPR compliance"
  use_case: "Third-party data sharing, regulatory reporting"
  min_k_anonymity: 10
  target_reidentification_risk: 0.01  # <1% acceptable risk

# Anonymization rules by PII type
anonymization_rules:
  # Direct identifiers - must be removed or heavily anonymized
  name:
    technique: "pseudonymize"
    params:
      method: "faker"
      preserve_format: true
      consistent: true  # Same input always produces same output
  
  email:
    technique: "hash"
    params:
      algorithm: "sha256"
      salt: true
      preserve_domain: false  # Don't preserve domain for max privacy
  
  phone:
    technique: "redact_full"
    params:
      replacement: "[REDACTED_PHONE]"
  
  ssn:
    technique: "redact_full"
    params:
      replacement: "[REDACTED_SSN]"
  
  credit_card:
    technique: "redact_full"
    params:
      replacement: "[REDACTED_CC]"
  
  ip_address:
    technique: "generalize"
    params:
      method: "subnet"
      subnet_mask: 16  # Keep only first two octets
  
  # Quasi-identifiers - generalize aggressively
  age:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 10
      format: "range"  # Output: "30-39"
  
  date_of_birth:
    technique: "generalize"
    params:
      method: "year_only"
      format: "decade"  # Output: "1980s"
  
  zipcode:
    technique: "generalize"
    params:
      method: "truncate"
      keep_digits: 3  # 10001 -> 100**
  
  address:
    technique: "generalize"
    params:
      method: "city_state_only"
      include_street: false
  
  city:
    technique: "preserve"
    params:
      validation: "check_population"
      min_population: 100000  # Only preserve if city >100k population
      fallback: "generalize_to_state"
  
  state:
    technique: "preserve"
    params: {}
  
  # Sensitive attributes - preserve but ensure diversity within equivalence classes
  income:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 25000
      format: "range"  # Output: "50000-74999"
  
  salary:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 25000
      format: "range"
  
  # Timestamps - generalize to reduce precision
  timestamp:
    technique: "generalize"
    params:
      method: "round"
      precision: "day"  # Remove time component
  
  datetime:
    technique: "generalize"
    params:
      method: "round"
      precision: "day"

# Privacy validation thresholds
privacy_thresholds:
  k_anonymity:
    enabled: true
    minimum_k: 10
    quasi_identifiers:
      - age
      - zipcode
      - gender
      - city
  
  l_diversity:
    enabled: true
    minimum_l: 2
    sensitive_attributes:
      - income
      - medical_condition
      - salary
  
  reidentification_risk:
    enabled: true
    max_risk_percent: 1.0  # Maximum 1% of records can be high risk

# Utility preservation targets
utility_targets:
  min_correlation_preservation: 0.75  # Maintain at least 75% of correlations
  min_distribution_similarity: 0.80   # 80% distribution similarity (KS test)
  acceptable_information_loss: 0.25   # Up to 25% information loss acceptable

# Output configuration
output:
  include_risk_scores: false  # Don't include risk scores in output (potential leak)
  include_original_ids: false  # Don't preserve original record IDs
  generate_compliance_report: true
  report_format: "html"

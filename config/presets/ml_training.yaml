# ML Training Anonymization Preset
# Balanced approach maximizing utility for machine learning workloads
# Suitable for: Training datasets, research collaboration, model development
# Focus: Preserve statistical properties and correlations

metadata:
  name: "ML Training Optimized"
  version: "1.0"
  description: "Maximize utility for ML training while maintaining privacy"
  use_case: "ML model training, statistical analysis, research"
  min_k_anonymity: 5  # Relaxed compared to GDPR
  target_reidentification_risk: 0.05  # <5% acceptable risk

# Anonymization rules optimized for ML utility
anonymization_rules:
  # Direct identifiers - still must be anonymized
  name:
    technique: "pseudonymize"
    params:
      method: "faker"
      preserve_format: true
      consistent: true
      preserve_demographics: true  # Preserve gender/ethnicity patterns
  
  email:
    technique: "hash"
    params:
      algorithm: "sha256"
      salt: true
      preserve_domain: true  # Keep domain for feature engineering
  
  phone:
    technique: "pseudonymize"
    params:
      method: "faker"
      preserve_area_code: true  # Geographic signal preserved
  
  ssn:
    technique: "hash"
    params:
      algorithm: "sha256"
      salt: true
  
  credit_card:
    technique: "redact_partial"
    params:
      visible_chars: 4  # Preserve card type (Visa/MC/etc) - keep last 4 digits
      mask_char: "*"
  
  ip_address:
    technique: "generalize"
    params:
      method: "subnet"
      subnet_mask: 24  # Keep more precision than GDPR (first 3 octets)
  
  # Quasi-identifiers - generalize lightly to preserve variance
  age:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 5  # Smaller bins = more utility
      format: "midpoint"  # Output: 32 (midpoint of 30-34)
      add_noise: true  # Optional: add small Laplacian noise
      noise_scale: 1.0
  
  date_of_birth:
    technique: "generalize"
    params:
      method: "generation_cohort"
      include_label: false  # Output: "1981-1996" (no label for ML features)
  
  dob:
    technique: "generalize"
    params:
      method: "generation_cohort"
      include_label: false
  
  zipcode:
    technique: "generalize"
    params:
      method: "truncate"
      keep_digits: 4  # 10001 -> 1000* (more precision than GDPR)
  
  address:
    technique: "generalize"
    params:
      method: "city_state_only"
      include_street: false
  
  city:
    technique: "preserve"
    params:
      validation: "check_population"
      min_population: 50000  # Lower threshold than GDPR
      fallback: "generalize_to_state"
  
  state:
    technique: "preserve"
    params: {}
  
  county:
    technique: "preserve"
    params: {}
  
  country:
    technique: "preserve"
    params: {}
  
  # Sensitive attributes - preserve with minimal transformation
  income:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 10000  # Smaller bins for ML
      format: "midpoint"  # Return numeric midpoint for regression
      preserve_outliers: true  # Keep high/low values for model training
  
  salary:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 10000
      format: "midpoint"
      preserve_outliers: true
  
  # Timestamps - preserve more precision than GDPR
  timestamp:
    technique: "generalize"
    params:
      method: "round"
      granularity: "day"  # Day-level precision (hour not supported)
  
  datetime:
    technique: "generalize"
    params:
      method: "round"
      granularity: "day"
  
  # Categorical features - preserve as-is (no PII)
  category:
    technique: "preserve"
    params: {}
  
  product_type:
    technique: "preserve"
    params: {}
  
  device_type:
    technique: "preserve"
    params: {}

# Privacy validation thresholds (relaxed for ML)
privacy_thresholds:
  k_anonymity:
    enabled: true
    minimum_k: 5  # Lower than GDPR
    quasi_identifiers:
      - age
      - zipcode
      - gender
      - city
    # Allow some records to have k<5 if they're outliers valuable for ML
    allow_outliers: true
    max_outlier_percent: 5.0
  
  l_diversity:
    enabled: true
    minimum_l: 2
    sensitive_attributes:
      - income
      - salary
  
  reidentification_risk:
    enabled: true
    max_risk_percent: 5.0  # Higher acceptable risk for ML use case

# Utility preservation targets (prioritized for ML)
utility_targets:
  min_correlation_preservation: 0.90  # Maintain 90% of correlations (critical for ML)
  min_distribution_similarity: 0.85   # 85% distribution similarity
  acceptable_information_loss: 0.15   # Only 15% information loss acceptable
  preserve_feature_importance: true   # Maintain relative feature importance
  
  # ML-specific metrics
  ml_metrics:
    test_model_performance: true
    model_types:
      - "random_forest"
      - "logistic_regression"
    min_accuracy_preservation: 0.95  # Model should perform â‰¥95% as well
    min_auc_preservation: 0.93

# Output configuration
output:
  include_risk_scores: true  # Include for analysis
  include_original_ids: true  # Map back to original for validation
  generate_compliance_report: true
  generate_utility_report: true
  report_format: "html"
  
  # ML-specific outputs
  include_feature_importance: true
  include_correlation_matrix: true
  include_distribution_plots: true

# Vendor Sharing Anonymization Preset
# Balanced approach for sharing data with business partners
# Suitable for: Analytics vendors, business partners, contractors
# Focus: Reasonable privacy with practical utility for business operations

metadata:
  name: "Vendor Sharing Balanced"
  version: "1.0"
  description: "Balanced anonymization for vendor/partner data sharing"
  use_case: "Vendor analytics, business intelligence, partner collaboration"
  min_k_anonymity: 7
  target_reidentification_risk: 0.03  # <3% acceptable risk

# Balanced anonymization rules
anonymization_rules:
  # Direct identifiers - anonymize but preserve business value
  name:
    technique: "pseudonymize"
    params:
      method: "faker"
      preserve_format: true
      consistent: true  # Same customer always same pseudonym
  
  email:
    technique: "hash"
    params:
      algorithm: "sha256"
      salt: true
      preserve_domain: true  # Useful for B2B analytics
  
  phone:
    technique: "redact_partial"
    params:
      visible_chars: 3  # Keep last 3 digits for reference
      mask_char: "*"
  
  ssn:
    technique: "redact_full"
    params:
      replacement: "[REDACTED]"
  
  credit_card:
    technique: "redact_partial"
    params:
      visible_chars: 6  # Preserve last 6 digits for payment analysis
      mask_char: "*"
  
  ip_address:
    technique: "generalize"
    params:
      method: "subnet"
      subnet_mask: 20  # Balance between GDPR and ML
  
  # Quasi-identifiers - moderate generalization
  age:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 5
      format: "range"  # Output: "30-34"
  
  date_of_birth:
    technique: "generalize"
    params:
      method: "year_only"
      format: "quarter"  # Output: quarter-level granularity
  
  zipcode:
    technique: "generalize"
    params:
      method: "truncate"
      keep_digits: 3  # Standard 3-digit generalization
  
  address:
    technique: "generalize"
    params:
      method: "city_state_only"
      include_street: false
  
  city:
    technique: "preserve"
    params:
      validation: "check_population"
      min_population: 75000  # Middle ground
      fallback: "generalize_to_state"
  
  state:
    technique: "preserve"
    params: {}
  
  # Sensitive attributes - balanced preservation
  income:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 15000
      format: "range"  # "45000-59999"
  
  salary:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 15000
      format: "range"
  
  # Business metrics - preserve with light anonymization
  purchase_amount:
    technique: "generalize"
    params:
      method: "round"
      round_to: 10  # Round to nearest $10
      preserve_zero: true
  
  transaction_count:
    technique: "preserve"
    params:
      cap_outliers: true  # Cap extreme values
      outlier_threshold: 3  # 3 standard deviations
  
  lifetime_value:
    technique: "generalize"
    params:
      method: "bins"
      bin_size: 500
      format: "midpoint"
  
  # Timestamps - reasonable precision
  timestamp:
    technique: "generalize"
    params:
      method: "round"
      precision: "day"  # Day precision (hour not supported)
  
  datetime:
    technique: "generalize"
    params:
      method: "round"
      precision: "day"
  
  # User behavior - preserve patterns
  session_duration:
    technique: "generalize"
    params:
      method: "round"
      round_to: 60  # Round to nearest minute
  
  page_views:
    technique: "preserve"
    params:
      cap_outliers: true
      outlier_threshold: 3
  
  # Categorical data - preserve for segmentation
  user_segment:
    technique: "preserve"
    params: {}
  
  product_category:
    technique: "preserve"
    params: {}
  
  acquisition_channel:
    technique: "preserve"
    params: {}
  
  device_type:
    technique: "preserve"
    params: {}

# Privacy validation thresholds (moderate)
privacy_thresholds:
  k_anonymity:
    enabled: true
    minimum_k: 7  # Balance between GDPR (10) and ML (5)
    quasi_identifiers:
      - age
      - zipcode
      - gender
      - city
  
  l_diversity:
    enabled: true
    minimum_l: 2
    sensitive_attributes:
      - income
      - purchase_amount
      - lifetime_value
  
  reidentification_risk:
    enabled: true
    max_risk_percent: 3.0  # 3% threshold

# Utility preservation targets (balanced)
utility_targets:
  min_correlation_preservation: 0.85  # 85% correlation preservation
  min_distribution_similarity: 0.80   # 80% distribution similarity
  acceptable_information_loss: 0.20   # 20% information loss acceptable
  
  # Business analytics validation
  business_metrics:
    preserve_segment_analysis: true
    preserve_trend_analysis: true
    min_aggregate_accuracy: 0.95  # Aggregates should be 95% accurate

# Output configuration
output:
  include_risk_scores: false  # Don't expose risk scores to vendors
  include_original_ids: false  # Use anonymized IDs only
  generate_compliance_report: true
  generate_utility_report: true
  report_format: "html"
  
  # Vendor-specific documentation
  include_data_dictionary: true  # Explain transformed fields
  include_usage_guidelines: true  # How to interpret anonymized data
  include_limitations: true  # What analyses are/aren't valid

# Data retention and contractual requirements
data_governance:
  require_dpa: true  # Data Processing Agreement required
  max_retention_days: 365
  require_deletion_certificate: true
  allowed_purposes:
    - "analytics"
    - "reporting"
    - "business_intelligence"
  prohibited_purposes:
    - "reidentification_attempts"
    - "direct_marketing"
    - "resale"
